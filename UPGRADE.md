# Upgrade notes

**Note:** This is a cumulative upgrade notes file, that provides detailed instructions
on how to migrate your previously generated Falcon-based project to a newer version.

> Make sure you remove your `node_modules` folders from both `client` and `server` apps
> to ensure a proper installation of NPM packages before any upgrade between Falcon versions.

## Falcon 0.2.0 to 0.3.0

Because of the significant amount of changes we recommend to update your existing application generated by `create-falcon-app` by applying the patch provided with v0.3.0 release which can be found [here](https://github.com/deity-io/falcon/releases/download/v0.3.0/falcon-update-020-030.patch).

Follow the steps below to apply the update:

1. Download the patch from [this url](https://github.com/deity-io/falcon/releases/download/v0.3.0/falcon-update-020-030.patch) and place it in the root of the application (next to the `client` and `server` folders)
2. Remove folders with already installed node modules: `client/node_modules` and `server/node_modules` and lock files (`client/yarn.lock` and `server/yarn.lock`)
3. Go to the root folder of the application in your terminal and make sure that you have `client` and `server` folders and `falcon-update-020-030.patch` file
4. Execute the following command:

```bash
git apply falcon-update-020-030.patch
```

5. If the above command warns about conflicts then resolve those as usual making sure that you preserve your changes
6. Install node modules in both `client` and `server` folders:

```bash
cd server
yarn install
cd ../client
yarn install
```

7. Run the server in one terminal and the client in another terminal

---

## Falcon 0.1.0 to 0.2.0

### Falcon-Server 0.2.0

- Change your `apis` and `extensions` config keys to the following structure:

```diff
{
  ...,
-  "apis": [
-    {
-      "name": "api-wordpress",
+  "apis": {
+    "api-wordpress": {
       "package": "@deity/falcon-wordpress-api",
       "config": {
         "host": "wordpress.deity.io",
         "protocol": "https",
         "apiPrefix": "/wp-json",
         "apiSuffix": "/wp/v2"
       }
     },
   },
```

- If you were using "endpoints" within your ApiDataSource class - you have to move them to a separate config
  section (read more about Endpoints [here](https://falcon.deity.io/docs/falcon-server/endpoints))
- `Events` enum object has been moved to `@deity/falcon-server-env` package:

```diff
- const { Events } = require('@deity/falcon-server');
+ const { Events } = require('@deity/falcon-server-env');
```

### Falcon-Client 0.2.0

- Rename `client/razzle.config.js` to `client/falcon-client.build.config.js`

```diff
- const { razzlePluginFalconClient } = require('@deity/falcon-client');

module.exports = {
-  plugins: [
-    razzlePluginFalconClient({
-      i18n: {
-        resourcePackages: ['@deity/falcon-i18n'],
-        filter: { lng: ['en'] }
-      }
-    })
-  ]
+  clearConsole: true,
+  useWebmanifest: true,
+  i18n: {
+    resourcePackages: ['@deity/falcon-i18n'],
+    filter: { lng: ['en'] }
+  }
};
```
